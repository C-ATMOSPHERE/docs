server {
	listen 		116.203.63.89:443 ssl http2;
	server_name dev.anilibria.tv;
	ssl_certificate /etc/letsencrypt/live/anilibria.tv/fullchain.pem;
	ssl_certificate_key /etc/letsencrypt/live/anilibria.tv/privkey.pem;
	root	/var/www/anilibria.tv/root;
	index  index.php index.html index.htm;
	
	error_page 403 /pages/error/403.php;
	error_page 404 /pages/error/404.php;
	error_page 502 /pages/error/502.html;
	
	rewrite  ^/release/(.*).html$  /pages/release.php?code=$1  last;
	
	location ~ ^/phpmyadmin {
		proxy_set_header Host $host;
		proxy_set_header X-Real-IP  $remote_addr;
		proxy_set_header X-Forwarded-For $remote_addr;
		proxy_pass http://127.0.0.1:80;
	}
	
	location ~ \.php$ {
		try_files $uri $uri/ =404;
		include fastcgi_params;
		fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
		fastcgi_param  PATH_TRANSLATED	  $document_root$fastcgi_script_name;
		fastcgi_pass unix:/var/run/anilibria.sock;
	}
}

server {
	listen      116.203.63.89:80 default_server;
	server_name dev.anilibria.tv;
	location ^~ /.well-known/ {
		root /var/www/html;
		default_type "text/plain";
	}
	location / {
		return       301 https://$host$request_uri;
	}
}
